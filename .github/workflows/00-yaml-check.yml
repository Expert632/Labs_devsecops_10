name: 00 - YAML Lint & Check

# Déclenche le pipeline à chaque push ou pull request sur main
on:
  push:
    branches:
      - main
  pull_request:
    types:
      - opened
      - synchronize
      - reopened

jobs:
  yamllint:
    runs-on: ubuntu-latest

    steps:
      # Étape 1 : Checkout du repo
      - name: Checkout repository
        uses: actions/checkout@v4

      # Étape 2 : Installer yamllint
      - name: Install yamllint
        run: pip install yamllint

      # Étape 3 : Lint des workflows GitHub
      - name: Lint GitHub workflows
        run: yamllint .github/workflows/*.yml || echo "No workflow YAML found"

      # Étape 4 : Lint des manifests Kubernetes
      - name: Lint Kubernetes manifests
        run: yamllint k8s/*.yaml || echo "No Kubernetes YAML found"

      # Étape 5 : Lint YAML Terraform (si existant)
      - name: Lint Terraform YAML
        run: yamllint terraform/*.yaml || echo "No Terraform YAML found"
